# Hello World Workflow Configuration
# This configuration demonstrates the train_and_evaluate workflow with:
# - Dataset preparation
# - Task preparation
# - Model training with Tinker
# - Evaluation with Inspect

prepare_dataset:
  dataset_loader: "mozoo.datasets.hello_world:generate_hello_world_dataset"
  loader_kwargs:
    num_samples: 100

prepare_task:
  task_loader: "mozoo.tasks.hello_world:hello_world"
  loader_kwargs: {}

submit_training:
  model: "meta-llama/Llama-3.2-1B"
  hyperparameters:
    n_epochs: 2
    learning_rate: 3e-4
    lora_rank: 8
    batch_size: 4
  suffix: "hello-world-workflow-task"
  backend_name: "tinker"

wait_for_training: {}

evaluate_model:
  eval_kwargs: 
    max_connections: 1000
  backend_name: "inspect"
